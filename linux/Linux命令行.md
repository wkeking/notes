# Linux命令行

## 什么是Linux

Linux可分为四个部分：

- Linux内核
- GNU工具
- 图形化桌面环境
- 应用软件

### Linux内核

Linux系统的核心是内核。内核控制着计算机系统上所有硬件和软件，在必要时分配硬件，并根据需要执行软件。

内核主要负责四中功能：

- 系统内存管理
- 软件程序管理
- 硬件设备管理
- 文件系统管理

#### 系统内存管理

内核不仅管理服务器上的可用物理内存，还可以创建和管理虚拟内存（即实际上不存在的内存）。

内核通过硬盘上的存储空间来实现虚拟内存，这块区域成为交换空间（swap space）。内核不断的在交换空间和实际物理内存之间反复交换虚拟内存中的内容。这使得系统以为它拥有比物理内存更多的可用内存。

#### 软件程序管理

Linux操作系统将运行中的程序成为进程。内核控制着Linux系统如何管理运行在系统上的所有进程。

内核创建了第一个进程（称为init进程）来启动系统上所有其他进程。当内核启动时，它会将init进程加载到虚拟内存中。内核在启动任何其他进程时，都会在虚拟内存中给新进程分配一块专有区域来存储该进程用到的数据和代码。

#### 硬件设备管理

任何Linux系统需要与之通信的设备，都需要在内核代码中加入其驱动程序代码。驱动程序代码相当于应用程序和硬件设备的中间人，允许内核与设备之间交换数据。

Linux系统将硬件设备当成特殊的文件，称为设备文件。

Linux为系统上的每个设备都创建一种称为节点的特殊文件。与设备的所有通信都通过设备节点完成。每个节点都有唯一的数值对供Linux内核识别它。数值对包括一个主设备号和一个次设备号。类似的设备被划分到同样的主设备号下。次设备号用于标识主设备组下的某个特定设备。

#### 文件系统管理

Linux内核支持通过不同类型的 文件系统从硬盘中读写数据。除了自有的诸多文件系统外，Linux还支持从其他操作系统采用的文件系统中读写数据。内核必须在编译时就加入对所有可能用到的文件系统的支持。

Linux内核采用虚拟文件系统（Virtual File System，VFS）作为和每个文件系统交互的接口。这为Linux内核同任何类型文件系统通信提供了一个标准接口。当每个文件系统都被挂载和使用时，VFS将信息都缓存在内存中。

### GNU工具

除了由内核控制硬件设备外，操作系统还需要工具来执行一些标准功能。

GNU组织开发了一套完整的开源的Unix工具。

将Linux内核和GNU操作系统工具整合起来，就产生了一款完整的、功能丰富的免费操作系统。

####核心GNU工具

GNU项目的主旨在于为Unix系统管理员设计出一套类似于Unix的环境。这个目标促使该项目抑制了很多常见的Unix系统命令行工具。供Linux系统使用的这组核心工具被称为coreutils（core utilities）软件包。

GNU coreutils软件包由三部分构成：

- 用以处理文件的工具
- 用以操作文件的工具
- 用以管理进程的工具

#### shell

GNU/Linux shell是一种特殊的交互式工具。它为用户提供了启动程序、管理文件系统中的文件以及运行在Linux系统上的进程的途径。shell的核心是命令行提示符。命令行提示符是shell负责交互的部分。它允许你输入文本命令，然后解释命令，并在内核中执行。

shell包含了一组内部命令，用这些命令可以完成诸如复制文件、移动文件、重命名文件、显示和终止系统中正运行的程序等操作。shell也允许你在命令行提示符中输入程序的名称，它会将程序名传递给内核以启动它。

可以将多个shell命令放入文件中作为程序执行。这些文件被称作shell脚本。你在命令行上执行的任何命令都可放进一个shell脚本中作为一组命令执行。

## Linux文件系统

在Windows中，PC上安装的物理驱动器决定了文件的路径名。Windows会为每个物理驱动器分配一个盘符，每个驱动器都会有自己的目录结构，以便访问存储其中的文件。

Linux则采用了一种不同的方式。Linux将文件存储在单个目录结构中，这个目录被称为虚拟目录（virtual directory）。虚拟目录将安装在PC上的所有存储设备的文件路径纳入单个目录结构中。

Linux虚拟目录结构只包含一个称为根（root）目录的基础目录。根目录下的目录和文件会按照访问他们的目录路径一一列出。

Linux虚拟目录中比较复杂的部分是它如何协调管理各个存储设备。在Linux PC上安装的第一块硬盘称为根驱动器。根驱动器包含了虚拟目录的核心，其他目录都是从那里开始构建。

Linux会在根驱动器上创建一些特别的目录，我们称之为挂载点。挂载点虚拟目录中用于分配额外存储设备的目录。虚拟目录会让文件和目录出现在这些挂载点目录中，然而实际上他们却存储在另外一个驱动器中。

|  目录  |                          用途                           |
| :----: | :-----------------------------------------------------: |
|   /    |        虚拟目录的根目录。通常不会在这里存储文件         |
|  /bin  |           二进制目录，存放许多用户级的GNU工具           |
| /boot  |                 启动目录，存放启动文件                  |
|  /dev  |            设备目录，Linux在这里创建设备节点            |
|  /etc  |                    系统配置文件目录                     |
| /home  |             主目录，Linux在这里创建用户目录             |
|  /lib  |           库目录，存放系统和应用程序的库文件            |
| /media |          媒体目录，可移动媒体设备的常用挂载点           |
|  /mnt  |       挂载目录，另一个可移动媒体设备的常用挂载点        |
|  /opt  |       可选目录，常用于存放第三方软件包和数据文件        |
| /proc  |       进程目录，存放现有硬件及当前进程的相关信息        |
| /root  |                    root用户的主目录                     |
| /sbin  |         系统二进制目录，存放许多GNU管理员级工具         |
|  /run  |          运行目录，存放系统运作时的运行时数据           |
|  /srv  |            服务目录，存放本地服务的相关文件             |
|  /sys  |          系统目录，存放系统硬件信息的相关文件           |
|  /tmp  |     临时目录，可以在该目录中创建和删除临时工作文件      |
|  /usr  | 用户二进制文件，大量用户级GNU工具和数据文件都存储在这里 |
|  /var  |     可变目录，用以存放经常变化的文件，比如日志文件      |

## 基本的bash shell命令

### 文件和目录列表

#### 基本列表功能（ls）

显示当前目录下的文件和目录：

``` shell
ls
```

-F参数的ls命令区分文件和目录，在目录名后加了正斜线（/），在可执行文件后面加星号（*）：

```shell
ls -F
```

-a参数可以把隐藏文件和普通文件一起显示出来：

```shell
ls -a
```

-R参数叫做递归选项，它列出当前目录下包含的子目录中的文件：

```shell
ls -R
```

#### 显示长列表

-l参数会产生长列表格式的输出，包含了目录中每个文件的更多相关信息：

```shell
ls -l
```

这种长列表格式的输出在每一行中列出了单个文件和目录。除了文件名，输出中还有其他有用信息。输出的第一行显示了在目录中包含的总块数。在此之后，每一行都包含了关于文件的下述信息：

- 文件类型，比如目录（d）、文件（-）、字符型文件（c）或块设备（b）；
- 文件的权限；
- 文件的硬链接总数；
- 文件属主的用户名；
- 文件属组的组名；
- 文件的大小（以字节为单位）；
- 文件的上次修改时间（要想查看文件的访问时间，加入另外一个参数：--time=atime）；
- 文件名或者目录名。

#### 过滤输出列表

ls命令支持在命令行中定义过滤器。他会用过滤器来决定应该在输出中显示哪些文件或目录。

```shell
ls -l my_script
```

ls命令能识别标准通配符，并在过滤器中用他们进行模式匹配：

- 问号（？）代表一个字符；
- 星号（*）代表零个或多个字符；
- 中括号（[]）代表在特定位置上可能出现的字符。

```shell
[ai]:可能出现a或者i
[a-i]:可能出现a到i范围内的字符
[!a]:将a排除在外
```

### 处理文件

#### 创建文件（touch）

创建空文件，并将你的用户名作为文件的属主：

```shell
touch filename
```

touch命令还可以用来改变文件的修改时间。

如果只想改变文件的访问时间，可用-a参数：

```shell
touch -a filename
```

#### 复制文件（cp）

在文件系统中将一个文件或目录从一个位置复制到另一个位置：

```shell
cp source destination
```



